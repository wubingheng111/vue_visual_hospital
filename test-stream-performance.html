<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æµå¼è¾“å‡ºæ€§èƒ½æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #1a1a1a;
            color: #fff;
        }
        .test-container {
            background: #2a2a2a;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .output-area {
            background: #333;
            padding: 15px;
            border-radius: 5px;
            min-height: 200px;
            margin: 10px 0;
            border: 1px solid #555;
        }
        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        button {
            padding: 10px 20px;
            background: #00ff88;
            color: #000;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }
        button:hover {
            background: #00cc6a;
        }
        .performance-info {
            background: #444;
            padding: 10px;
            border-radius: 5px;
            margin-top: 10px;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <h1>æ™ºèƒ½é—®è¯Šæµå¼è¾“å‡ºæ€§èƒ½æµ‹è¯•</h1>
    
    <div class="test-container">
        <h2>æµ‹è¯•è¯´æ˜</h2>
        <p>è¿™ä¸ªé¡µé¢ç”¨äºæµ‹è¯•ä¸åŒæµå¼è¾“å‡ºæ¨¡å¼çš„æ€§èƒ½è¡¨ç°ï¼š</p>
        <ul>
            <li><strong>ç¬æ—¶æ¨¡å¼ (âš¡)</strong>: ç«‹å³æ˜¾ç¤ºå…¨éƒ¨å†…å®¹ï¼Œæ— åŠ¨ç”»</li>
            <li><strong>å¿«é€Ÿæ¨¡å¼ (ğŸš€)</strong>: 8ä¸ªåˆ†å—å¿«é€Ÿæ˜¾ç¤º</li>
            <li><strong>æ­£å¸¸æ¨¡å¼ (ğŸ“)</strong>: ä¼˜åŒ–çš„DOMæ“ä½œï¼Œå¹³è¡¡æ€§èƒ½å’Œä½“éªŒ</li>
            <li><strong>æ…¢é€Ÿæ¨¡å¼ (ğŸŒ)</strong>: æŒ‰å¥å­åˆ†å‰²æ˜¾ç¤º</li>
        </ul>
    </div>

    <div class="test-container">
        <h2>æ€§èƒ½æµ‹è¯•</h2>
        <div class="controls">
            <button onclick="testMode('instant')">âš¡ ç¬æ—¶æ¨¡å¼</button>
            <button onclick="testMode('fast')">ğŸš€ å¿«é€Ÿæ¨¡å¼</button>
            <button onclick="testMode('normal')">ğŸ“ æ­£å¸¸æ¨¡å¼</button>
            <button onclick="testMode('slow')">ğŸŒ æ…¢é€Ÿæ¨¡å¼</button>
            <button onclick="clearOutput()">æ¸…ç©º</button>
        </div>
        
        <div class="output-area" id="outputArea"></div>
        <div class="performance-info" id="performanceInfo">
            ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®å¼€å§‹æµ‹è¯•...
        </div>
    </div>

    <script>
        const testText = `# AIåŒ»ç”Ÿè¯Šæ–­æŠ¥å‘Š

## ç—‡çŠ¶åˆ†æ
æ ¹æ®æ‚¨æè¿°çš„ç—‡çŠ¶ï¼Œæˆ‘è¿›è¡Œäº†ä»¥ä¸‹åˆ†æï¼š

### ä¸»è¦ç—‡çŠ¶
1. **å¤´ç—›** - å¯èƒ½ä¸å‹åŠ›ã€ç¡çœ ä¸è¶³æˆ–è¡€å‹æœ‰å…³
2. **å‘çƒ­** - ä½“æ¸©å‡é«˜ï¼Œå¯èƒ½å­˜åœ¨æ„ŸæŸ“
3. **å’³å—½** - å‘¼å¸é“ç—‡çŠ¶ï¼Œéœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥

### å»ºè®®æ£€æŸ¥é¡¹ç›®
- è¡€å¸¸è§„æ£€æŸ¥
- èƒ¸éƒ¨Xå…‰ç‰‡
- è¡€å‹æµ‹é‡
- ä½“æ¸©ç›‘æµ‹

### ç”¨è¯å»ºè®®
**æ³¨æ„ï¼šä»¥ä¸‹å»ºè®®ä»…ä¾›å‚è€ƒï¼Œè¯·éµåŒ»å˜±ç”¨è¯**

1. **é€€çƒ­è¯ç‰©**ï¼šå¦‚æœ‰å‘çƒ­è¶…è¿‡38.5Â°Cï¼Œå¯æœç”¨å¯¹ä¹™é…°æ°¨åŸºé…š
2. **æ­¢å’³è¯ç‰©**ï¼šå¯ä½¿ç”¨èœ‚èœœæŸ æª¬èŒ¶ç¼“è§£å’³å—½
3. **å¤šä¼‘æ¯**ï¼šä¿è¯å……è¶³ç¡çœ ï¼Œé¿å…è¿‡åº¦åŠ³ç´¯

### æ³¨æ„äº‹é¡¹
- å¦‚ç—‡çŠ¶æŒç»­åŠ é‡ï¼Œè¯·åŠæ—¶å°±åŒ»
- ä¿æŒå……è¶³æ°´åˆ†æ‘„å…¥
- é¿å…æ¥è§¦ä»–äººï¼Œé˜²æ­¢ä¼ æŸ“

### å¤è¯Šå»ºè®®
å»ºè®®3-5å¤©åå¤è¯Šï¼Œå¦‚æœ‰ä»¥ä¸‹æƒ…å†µè¯·ç«‹å³å°±åŒ»ï¼š
- é«˜çƒ­ä¸é€€ï¼ˆè¶…è¿‡39Â°Cï¼‰
- å‘¼å¸å›°éš¾
- èƒ¸ç—›åŠ é‡
- æ„è¯†æ¨¡ç³Š

**ç¥æ‚¨æ—©æ—¥åº·å¤ï¼**`;

        let currentMode = 'normal';
        
        async function testMode(mode) {
            currentMode = mode;
            const outputArea = document.getElementById('outputArea');
            const performanceInfo = document.getElementById('performanceInfo');
            
            outputArea.innerHTML = '';
            performanceInfo.textContent = `æ­£åœ¨æµ‹è¯• ${getModeText(mode)} æ¨¡å¼...`;
            
            const startTime = performance.now();
            
            switch (mode) {
                case 'instant':
                    await instantMode(testText, outputArea);
                    break;
                case 'fast':
                    await fastMode(testText, outputArea);
                    break;
                case 'normal':
                    await normalMode(testText, outputArea);
                    break;
                case 'slow':
                    await slowMode(testText, outputArea);
                    break;
            }
            
            const endTime = performance.now();
            const duration = (endTime - startTime).toFixed(2);
            
            performanceInfo.innerHTML = `
                <strong>${getModeText(mode)} æ¨¡å¼æµ‹è¯•å®Œæˆ</strong><br>
                æ€»è€—æ—¶: ${duration}ms<br>
                æ–‡æœ¬é•¿åº¦: ${testText.length} å­—ç¬¦<br>
                å¹³å‡é€Ÿåº¦: ${(testText.length / (duration / 1000)).toFixed(0)} å­—ç¬¦/ç§’
            `;
        }
        
        function getModeText(mode) {
            const modeNames = {
                instant: 'âš¡ ç¬æ—¶æ˜¾ç¤º',
                fast: 'ğŸš€ å¿«é€Ÿæ˜¾ç¤º',
                normal: 'ğŸ“ æ­£å¸¸é€Ÿåº¦',
                slow: 'ğŸŒ æ…¢é€Ÿæ˜¾ç¤º'
            };
            return modeNames[mode] || 'æœªçŸ¥æ¨¡å¼';
        }
        
        async function instantMode(text, container) {
            container.innerHTML = formatMarkdown(text);
        }
        
        async function fastMode(text, container) {
            const chunkCount = 8;
            const chunkSize = Math.ceil(text.length / chunkCount);
            
            for (let i = 0; i < chunkCount; i++) {
                const end = Math.min((i + 1) * chunkSize, text.length);
                const currentText = text.slice(0, end);
                
                if (i === chunkCount - 1) {
                    container.innerHTML = formatMarkdown(currentText);
                } else {
                    container.textContent = currentText;
                    await new Promise(resolve => setTimeout(resolve, 100));
                }
            }
        }
        
        async function normalMode(text, container) {
            const totalLength = text.length;
            const chunkSize = Math.max(30, Math.floor(totalLength / 15));
            const updateInterval = 80;
            let currentIndex = 0;
            
            return new Promise(resolve => {
                const performUpdate = () => {
                    if (currentIndex >= totalLength) {
                        container.innerHTML = formatMarkdown(text);
                        resolve();
                        return;
                    }
                    
                    const nextIndex = Math.min(currentIndex + chunkSize, totalLength);
                    const currentText = text.slice(0, nextIndex);
                    
                    if (isGoodBreakPoint(text, nextIndex) || nextIndex === totalLength) {
                        container.innerHTML = formatMarkdown(currentText);
                    } else {
                        container.textContent = currentText;
                    }
                    
                    currentIndex = nextIndex;
                    setTimeout(performUpdate, updateInterval);
                };
                
                performUpdate();
            });
        }
        
        async function slowMode(text, container) {
            const sentences = text.split(/([ã€‚ï¼ï¼Ÿ\n])/);
            let currentText = '';
            
            for (let i = 0; i < sentences.length; i += 2) {
                const sentence = sentences[i] || '';
                const punctuation = sentences[i + 1] || '';
                currentText += sentence + punctuation;
                
                container.textContent = currentText;
                
                if (i < sentences.length - 2) {
                    await new Promise(resolve => setTimeout(resolve, 800));
                }
            }
            
            container.innerHTML = formatMarkdown(text);
        }
        
        function isGoodBreakPoint(text, index) {
            if (index >= text.length) return true;
            
            const char = text[index - 1];
            const nextChar = text[index];
            
            return char === 'ã€‚' || char === 'ï¼Ÿ' || char === 'ï¼' || char === '\n' ||
                   (char === 'ï¼Œ' && nextChar === ' ') ||
                   (char === ' ' && /[A-Z]/.test(nextChar));
        }
        
        function formatMarkdown(text) {
            // ç®€åŒ–çš„Markdownæ¸²æŸ“
            return text
                .replace(/^# (.*$)/gm, '<h1>$1</h1>')
                .replace(/^## (.*$)/gm, '<h2>$1</h2>')
                .replace(/^### (.*$)/gm, '<h3>$1</h3>')
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/\*(.*?)\*/g, '<em>$1</em>')
                .replace(/^- (.*$)/gm, '<li>$1</li>')
                .replace(/^(\d+)\. (.*$)/gm, '<li>$1. $2</li>')
                .replace(/\n/g, '<br>');
        }
        
        function clearOutput() {
            document.getElementById('outputArea').innerHTML = '';
            document.getElementById('performanceInfo').textContent = 'è¾“å‡ºå·²æ¸…ç©º';
        }
    </script>
</body>
</html>
